### 整理发送/消费消息过程中的问题

### 可靠消息问题


### 可靠消息的处理
**发送消息时**
- 确保消息被发送到 MQ；发消息前插一条记录，消息被确认接收后，异步删除数据。
- 需要注意：MQ 发送消息是异步的，所以要确保消息被插入到了数据。才发送数据。
- 如果消息没被确认，使用定时任务扫表，重发消息。

流程如下图：
![消息补偿](./../images/mq/消息补偿.jpg)

**消费消息时**
- 